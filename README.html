<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.21.2: https://docutils.sourceforge.io/" />
<title>t Process in Scikit Learn</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 9511 2024-01-13 09:50:07Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.
Despite the name, some widely supported CSS2 features are used.

See https://docutils.sourceforge.io/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: gray; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic, pre.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
<style type="text/css">

/*
*   math2html: convert LaTeX equations to HTML output.
*
*   Copyright (C) 2009,2010 Alex Fernández
*                 2021      Günter Milde
*
*   Released under the terms of the `2-Clause BSD license'_, in short:
*   Copying and distribution of this file, with or without modification,
*   are permitted in any medium without royalty provided the copyright
*   notice and this notice are preserved.
*   This file is offered as-is, without any warranty.
*
* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause
*
*   Based on eLyXer: convert LyX source files to HTML output.
*   http://elyxer.nongnu.org/
*
*
* CSS file for LaTeX formulas.
*
* References: http://www.zipcon.net/~swhite/docs/math/math.html
*             http://www.cs.tut.fi/~jkorpela/math/
*/

/* Formulas */
.formula {
	text-align: center;
	margin: 1.2em 0;
	line-height: 1.4;
}
span.formula {
	white-space: nowrap;
}
div.formula {
	padding: 0.5ex;
	margin-left: auto;
	margin-right: auto;
}

/* Basic features */
a.eqnumber {
	display: inline-block;
	float: right;
	clear: right;
	font-weight: bold;
}
span.unknown {
	color: #800000;
}
span.ignored, span.arraydef {
	display: none;
}
.phantom {
	visibility: hidden;
}
.formula i {
	letter-spacing: 0.1ex;
}

/* Alignment */
.align-l {
	text-align: left;
}
.align-r {
	text-align: right;
}
.align-c {
	text-align: center;
}

/* Structures */
span.hspace {
	display: inline-block;
}
span.overline, span.bar {
	text-decoration: overline;
}
.fraction, .fullfraction, .textfraction {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
}
span.formula .fraction,
.textfraction,
span.smallmatrix {
	font-size: 80%;
	line-height: 1;
}
span.numerator {
	display: block;
	line-height: 1;
}
span.denominator {
	display: block;
	line-height: 1;
	padding: 0ex;
	border-top: thin solid;
}
.formula sub, .formula sup {
	font-size: 80%;
}
sup.numerator, sup.unit {
	vertical-align: 80%;
}
sub.denominator, sub.unit {
	vertical-align: -20%;
}
span.smallsymbol {
	font-size: 75%;
	line-height: 75%;
}
span.boldsymbol {
	font-weight: bold;
}
span.sqrt {
	display: inline-block;
	vertical-align: middle;
	padding: 0.1ex;
}
sup.root {
	position: relative;
	left: 1.4ex;
}
span.radical {
	display: inline-block;
	padding: 0ex;
	/* font-size: 160%; for DejaVu, not required with STIX */
	line-height: 100%;
	vertical-align: top;
	vertical-align: middle;
}

span.root {
	display: inline-block;
	border-top: thin solid;
	padding: 0ex;
	vertical-align: middle;
}
div.formula .bigoperator,
.displaystyle .bigoperator,
.displaystyle .bigoperator {
	line-height: 120%;
	font-size: 140%;
	padding-right: 0.2ex;
}
span.fraction .bigoperator,
span.scriptstyle .bigoperator {
	line-height: inherit;
	font-size: inherit;
	padding-right: 0;
}
span.bigdelimiter {
	display: inline-block;
}
span.bigdelimiter.size1 {
	transform: scale(1, 1.2);
	line-height: 1.2;
}
span.bigdelimiter.size2 {
	transform: scale(1, 1.62);
	line-height: 1.62%;

}
span.bigdelimiter.size3 {
	transform: scale(1, 2.05);
	line-height: 2.05%;
}
span.bigdelimiter.size4 {
	transform: scale(1, 2.47);
	line-height: 2.47%;
}
/* vertically stacked sub and superscript */
span.scripts {
	display: inline-table;
	vertical-align: middle;
	padding-right: 0.2ex;
}
.script {
	display: table-row;
	text-align: left;
	line-height: 150%;
}
span.limits {
	display: inline-table;
	vertical-align: middle;
}
.limit {
	display: table-row;
	line-height: 99%;
}
sup.limit, sub.limit {
	line-height: 100%;
}
span.embellished,
span.embellished > .base {
	display: inline-block;
}
span.embellished > sup,
span.embellished > sub {
	display: inline-block;
	font-size: 100%;
	position: relative;
	bottom: 0.3em;
	width: 0px;
}
span.embellished > sub {
	top: 0.4em;
}

/* Environments */
span.array, span.bracketcases, span.binomial, span.environment {
	display: inline-table;
	text-align: center;
	vertical-align: middle;
}
span.arrayrow, span.binomrow {
	display: table-row;
	padding: 0;
	border: 0;
}
span.arraycell, span.bracket, span.case, span.binomcell, span.environmentcell {
	display: table-cell;
	padding: 0ex 0.2ex;
	line-height: 1; /* 99%; */
	border: 0ex;
}
.environment.align > .arrayrow > .arraycell.align-l {
	padding-right: 2em;
}

/* Inline binomials */
span.binom {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
	font-size: 80%;
}
span.binomstack {
	display: block;
	padding: 0em;
}

/* Over- and underbraces */
span.overbrace {
	border-top: 2pt solid;
}
span.underbrace {
	border-bottom: 2pt solid;
}

/* Stackrel */
span.stackrel {
	display: inline-block;
	text-align: center;
}
span.upstackrel {
	display: block;
	padding: 0em;
	font-size: 80%;
	line-height: 64%;
	position: relative;
	top: 0.15em;

}
span.downstackrel {
	display: block;
	vertical-align: bottom;
	padding: 0em;
}

/* Fonts */
.formula {
	font-family: STIX, "DejaVu Serif", "DejaVu Math TeX Gyre", serif;
}
span.radical,   /* ensure correct size of square-root sign */
span.integral { /* upright integral signs for better alignment of indices */
	font-family: "STIXIntegralsUp", STIX;
	/* font-size: 115%; match apparent size with DejaVu */
}
span.bracket {
  /* some "STIX" and "DejaVu Math TeX Gyre" bracket pieces don't fit */
	font-family: "DejaVu Serif", serif;
}
span.mathsf, span.textsf {
	font-family: sans-serif;
}
span.mathrm, span.textrm {
	font-family: STIX, "DejaVu Serif", "DejaVu Math TeX Gyre", serif;
}
span.mathtt, span.texttt {
	font-family: monospace;
}
span.text, span.textnormal,
span.mathsf, span.mathtt, span.mathrm {
	font-style: normal;
}
span.fraktur {
	font-family: "Lucida Blackletter", eufm10, blackletter;
}
span.blackboard {
	font-family: Blackboard, msbm10, serif;
}
span.scriptfont {
	font-family: "Monotype Corsiva", "Apple Chancery", "URW Chancery L", cursive;
	font-style: italic;
}
span.mathscr {
  font-family: MathJax_Script, rsfs10,  cursive;
  font-style: italic;
}
span.textsc {
	font-variant: small-caps;
}
span.textsl {
	font-style: oblique;
}

/* Colors */
span.colorbox {
	display: inline-block;
	padding: 5px;
}
span.fbox {
	display: inline-block;
	border: thin solid black;
	padding: 2px;
}
span.boxed, span.framebox {
	display: inline-block;
	border: thin solid black;
	padding: 5px;
}

</style>
</head>
<body>
<div class="document" id="t-process-in-scikit-learn">
<h1 class="title"><span class="formula"><i>t</i></span> Process in Scikit Learn</h1>

<p>This is a simple demo showcasing the integration of <span class="formula"><i>t</i></span> processes
(TP)s into the scikit learn python package. First, the existing
functionality of Gaussian Processes (GP)s will be demonstrated, then the
same will be done for TPs showcasing their similar interfaces and
behavioural differences.</p>
<p>This is not meant to be a coprehensive overview of GPs and TPs, for more
background information see [RW2006], [SW2014], [TW2018] and [S2024].</p>
<div class="section" id="scikit-learn-gaussian-processes-interface">
<h1>Scikit Learn Gaussian Processes Interface</h1>
<p>A simple example of GP regression in scikit learn is as follows:</p>
<pre class="code ipython3 literal-block">
<span class="keyword namespace">from</span> <span class="name namespace">sklearn.gaussian_process</span> <span class="keyword namespace">import</span> <span class="name">GaussianProcessRegressor</span><span class="whitespace">
</span><span class="keyword namespace">from</span> <span class="name namespace">sklearn.gaussian_process.kernels</span> <span class="keyword namespace">import</span> <span class="name">RBF</span><span class="punctuation">,</span> <span class="name">ConstantKernel</span><span class="punctuation">,</span> <span class="name">ExpSineSquared</span><span class="whitespace">
</span><span class="keyword namespace">import</span> <span class="name namespace">numpy</span> <span class="keyword">as</span> <span class="name namespace">np</span><span class="whitespace">

</span><span class="name">X_train</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">array</span><span class="punctuation">([[</span><span class="operator">-</span><span class="literal number integer">3</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="operator">-</span><span class="literal number integer">2</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="operator">-</span><span class="literal number integer">1</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">2</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">3</span><span class="punctuation">]])</span><span class="whitespace">
</span><span class="name">Y_train</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">sin</span><span class="punctuation">(</span><span class="name">X_train</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">X_predict</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">array</span><span class="punctuation">([[</span><span class="operator">-</span><span class="literal number float">1.5</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="operator">-</span><span class="literal number float">0.5</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number float">0.5</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number float">1.5</span><span class="punctuation">]])</span><span class="whitespace">

</span><span class="name">kernel</span> <span class="operator">=</span> <span class="name">RBF</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">,</span> <span class="name">length_scale_bounds</span><span class="operator">=</span><span class="literal string double">&quot;fixed&quot;</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name">gpr</span> <span class="operator">=</span> <span class="name">GaussianProcessRegressor</span><span class="punctuation">(</span><span class="name">kernel</span><span class="operator">=</span><span class="name">kernel</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="operator">=</span><span class="literal number float">0.0001</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">fit</span><span class="punctuation">(</span><span class="name">X_train</span><span class="punctuation">,</span> <span class="name">Y_train</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">means</span><span class="punctuation">,</span> <span class="name">stds</span> <span class="operator">=</span> <span class="name">gpr</span><span class="operator">.</span><span class="name">predict</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">,</span> <span class="name">return_std</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name builtin">print</span><span class="punctuation">(</span><span class="literal string single">'</span><span class="literal string escape">\n</span><span class="literal string single">Mean of predictions:'</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name builtin">print</span><span class="punctuation">(</span><span class="name">means</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name builtin">print</span><span class="punctuation">(</span><span class="literal string single">'</span><span class="literal string escape">\n</span><span class="literal string single"> Standard deviation of predictions:'</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name builtin">print</span><span class="punctuation">(</span><span class="name">stds</span><span class="punctuation">)</span>
</pre>
<pre class="literal-block">
Mean of predictions:
[-1.02199222 -0.4616725   0.4616725   1.02199222]

 Standard deviation of predictions:
[0.08621517 0.0786525  0.0786525  0.08621517]
</pre>
<p>To better visualize the predictions they can be plotted:</p>
<pre class="code ipython3 literal-block">
<span class="name">X_predict</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">linspace</span><span class="punctuation">(</span><span class="operator">-</span><span class="literal number integer">10</span><span class="punctuation">,</span> <span class="literal number integer">10</span><span class="punctuation">,</span> <span class="name">num</span><span class="operator">=</span><span class="literal number integer">300</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">reshape</span><span class="punctuation">(</span><span class="operator">-</span><span class="literal number integer">1</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">Y_true</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">sin</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name">means</span><span class="punctuation">,</span> <span class="name">stds</span> <span class="operator">=</span> <span class="name">gpr</span><span class="operator">.</span><span class="name">predict</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">,</span> <span class="name">return_std</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">confs</span> <span class="operator">=</span> <span class="name">vec_norm_conf_gp</span><span class="punctuation">(</span><span class="name">stds</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">topConf</span> <span class="operator">=</span> <span class="name">means</span> <span class="operator">+</span> <span class="name">confs</span><span class="whitespace">
</span><span class="name">botConf</span> <span class="operator">=</span> <span class="name">means</span> <span class="operator">-</span> <span class="name">confs</span><span class="whitespace">

</span><span class="name">plot_stochastic_process</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">,</span> <span class="name">Y_true</span><span class="punctuation">,</span> <span class="name">means</span><span class="punctuation">,</span> <span class="name">botConf</span><span class="punctuation">,</span> <span class="name">topConf</span><span class="punctuation">,</span> <span class="literal string single">'GP'</span><span class="punctuation">)</span>
</pre>
<img alt="sklearn/gaussian_process/media/figures/output_5_0.png" src="sklearn/gaussian_process/media/figures/output_5_0.png" />
</div>
<div class="section" id="t-processes-interface">
<h1><span class="formula"><i>t</i></span> Processes Interface</h1>
<p>In short, TPs are generated by placing a conjugate prior over the
covariance matrix of a GP then subsequently marginalizing it out. There
are two primary advantages of using TPs over GPs: 1. TPs scale the
covariance of the stochastic process in a Bayesian way. 2. The marginal
distributions of TPs are <span class="formula"><i>t</i></span> distributions, making them <em>heavier
tailed</em> and thus more robust to outliers.</p>
<p>Much of the literature focuses on the second property of TPs [SW2014],
[TW2018] and [RW2006].</p>
<p>The primary disadvantage of TPs are that they cannot handle noisy
observations analytically. This implementation uses the common approach
of adding noise to the covariance matrix before a prior is placed over
it as proposed by [SW2014]. See [S2024] for a deeper analysis of this
and approximation techniques of noisy Bayesian TPs.</p>
<div class="section" id="t-processes-in-scikit-learn">
<h2><span class="formula"><i>t</i></span> Processes in Scikit Learn</h2>
<p>This <a class="reference external" href="https://github.com/conradstevens/scikit-learn">fork</a> of scikit
learn implements TPs as a subclass of GPs giving a simple interface
similar to that of GPs in scikit learn. Consider the following example:</p>
<pre class="code ipython3 literal-block">
<span class="keyword namespace">from</span> <span class="name namespace">sklearn.gaussian_process</span> <span class="keyword namespace">import</span> <span class="name">TProcessRegressor</span><span class="whitespace">

</span><span class="name">X_train</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">array</span><span class="punctuation">([[</span><span class="operator">-</span><span class="literal number integer">3</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="operator">-</span><span class="literal number integer">2</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="operator">-</span><span class="literal number integer">1</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">2</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">3</span><span class="punctuation">]])</span><span class="whitespace">
</span><span class="name">Y_train</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">sin</span><span class="punctuation">(</span><span class="name">X_train</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">X_predict</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">array</span><span class="punctuation">([[</span><span class="operator">-</span><span class="literal number float">1.5</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="operator">-</span><span class="literal number float">0.5</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number float">0.5</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number float">1.5</span><span class="punctuation">]])</span><span class="whitespace">

</span><span class="name">kernel</span> <span class="operator">=</span> <span class="name">RBF</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">,</span> <span class="name">length_scale_bounds</span><span class="operator">=</span><span class="literal string double">&quot;fixed&quot;</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name">tpr</span> <span class="operator">=</span> <span class="name">TProcessRegressor</span><span class="punctuation">(</span><span class="name">kernel</span><span class="operator">=</span><span class="name">kernel</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="operator">=</span><span class="literal number float">0.0001</span><span class="punctuation">,</span> <span class="name">v</span><span class="operator">=</span><span class="literal number integer">5</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">fit</span><span class="punctuation">(</span><span class="name">X_train</span><span class="punctuation">,</span> <span class="name">Y_train</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">means</span><span class="punctuation">,</span> <span class="name">stds</span> <span class="operator">=</span> <span class="name">tpr</span><span class="operator">.</span><span class="name">predict</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">,</span> <span class="name">return_std</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name builtin">print</span><span class="punctuation">(</span><span class="literal string single">'</span><span class="literal string escape">\n</span><span class="literal string single">Mean of predictions:'</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name builtin">print</span><span class="punctuation">(</span><span class="name">means</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name builtin">print</span><span class="punctuation">(</span><span class="literal string single">'</span><span class="literal string escape">\n</span><span class="literal string single"> Standard deviation of predictions:'</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name builtin">print</span><span class="punctuation">(</span><span class="name">stds</span><span class="punctuation">)</span>
</pre>
<pre class="literal-block">
Mean of predictions:
[-1.02199222 -0.4616725   0.4616725   1.02199222]

 Standard deviation of predictions:
[0.06274391 0.0572401  0.0572401  0.06274391]
</pre>
<p>Remark, the mean values are the same, however the standard deviation is
smaller as a result of scaling the covariance in a Bayesian way. See
below the sin wave example using TPs:</p>
<pre class="code ipython3 literal-block">
<span class="name">X_predict</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">linspace</span><span class="punctuation">(</span><span class="operator">-</span><span class="literal number integer">10</span><span class="punctuation">,</span> <span class="literal number integer">10</span><span class="punctuation">,</span> <span class="name">num</span><span class="operator">=</span><span class="literal number integer">300</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">reshape</span><span class="punctuation">(</span><span class="operator">-</span><span class="literal number integer">1</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name">means</span><span class="punctuation">,</span> <span class="name">stds</span> <span class="operator">=</span> <span class="name">tpr</span><span class="operator">.</span><span class="name">predict</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">,</span> <span class="name">return_std</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">confs</span> <span class="operator">=</span> <span class="name">vec_norm_conf_tp</span><span class="punctuation">(</span><span class="name">stds</span><span class="punctuation">,</span> <span class="name">tpr</span><span class="operator">.</span><span class="name">v</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">topConf</span> <span class="operator">=</span> <span class="name">means</span> <span class="operator">+</span> <span class="name">confs</span><span class="whitespace">
</span><span class="name">botConf</span> <span class="operator">=</span> <span class="name">means</span> <span class="operator">-</span> <span class="name">confs</span><span class="whitespace">

</span><span class="name">plot_stochastic_process</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">,</span> <span class="name">Y_true</span><span class="punctuation">,</span> <span class="name">means</span><span class="punctuation">,</span> <span class="name">botConf</span><span class="punctuation">,</span> <span class="name">topConf</span><span class="punctuation">,</span> <span class="literal string single">'TP'</span><span class="punctuation">)</span>
</pre>
<img alt="sklearn/gaussian_process/media/figures/output_10_0.png" src="sklearn/gaussian_process/media/figures/output_10_0.png" style="width: 612.0px; height: 474.0px;" />
<p>It can be seen the covariance of the distribution is scaled down
following the observations. Also note the marginal distributions at each
<span class="formula"><i>x</i></span> index are <span class="formula"><i>t</i></span> distributions.</p>
</div>
</div>
<div class="section" id="gp-and-tp-sampled-regressions">
<h1>GP and TP Sampled Regressions</h1>
<p>To demonstrate the <em>heavier tailed</em> properties of TPs versus GPs a
series of regression can be sampled from each prior and compared.</p>
<img alt="sklearn/gaussian_process/media/figures/output_13_0.png" src="sklearn/gaussian_process/media/figures/output_13_0.png" />
<img alt="sklearn/gaussian_process/media/figures/output_14_0.png" src="sklearn/gaussian_process/media/figures/output_14_0.png" />
<p>It can be seen that as a consequence of the <span class="formula"><i>t</i></span> distribution
shape, sampled regressions from the TP prior are more volatile and
extend outside the bounds more often.</p>
</div>
<div class="section" id="kernel-parameter-training">
<h1>Kernel Parameter Training</h1>
<p>In the previous examples, kernel parameters were fixed to best show the
scaling properties of TPs. This section will show the implementation of
kernel parameter training used to maximize the log-likelihood of the
observed data, theoretically giving kernel of best fit:</p>
<div class="formula">
<span class="limits"><sup class="limit"> </sup><span class="limit">max</span><sub class="limit"><i>θ</i></sub></span><span class="thickspace"> </span>ln<span class="bigdelimiter size1">(</span><i>p</i>(<i>Z</i><sub><i>n</i></sub>)<span class="bigdelimiter size1">)</span>
</div>
<p>Where <span class="formula"><i>θ</i></span> are the kernel parameters and <span class="formula"><i>Z</i><sub><i>n</i></sub></span> are the
observed data points.</p>
<div class="section" id="gaussian-process-kernel-parameter-training">
<h2>Gaussian Process Kernel Parameter Training</h2>
<p>The kernel parameter training technique implemented in scikit learn is
based of [RW2006] Algorithm 2.1 and scipy’s <em>fmin_l_bfgs_b</em> optimizer.
To compute the log-likelihood and its derivative, first consider:</p>
<div class="formula">
<span class="environment align"><span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
<span class="text">Let </span><i>K</i> :  = <i>K</i><sub><i>nn</i></sub> + Σ<sub><i>z</i></sub>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
<span class="text">Let </span><i>Y</i> :  = <i>Z</i><sub><i>n</i></sub> − <i>ϕ</i>(<i>T</i><sub><i>n</i></sub>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
<span class="text">Let </span><i>L</i> :  = <span class="text">Cholesky</span>(<i>K</i>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
<span class="text">Let </span><i>l</i><sub><i>ii</i></sub> :  = <span class="text">the </span><i>i</i><sup><i>th</i></sup><span class="text"> diagonal of $L$</span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
<span class="text">Let </span><i>α</i> :  = <i>L</i><sup><i>T</i></sup>\(<i>L</i>\<i>Y</i>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
<span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span> = <i>K</i><sup> − 1</sup><i>Y</i>
</span>

</span>
</span>
</div>
<p>Where <span class="formula"><i>Z</i><sub><i>n</i></sub></span> are the observed points. Then:</p>
<div class="formula">
<span class="environment align"><span class="arrayrow">
<span class="arraycell align-r">
ln(<i>p</i>(<i>Z</i><sub><i>n</i></sub>))
</span>
<span class="arraycell align-l">
 =  − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><i>Y</i><span class="scripts"><sup class="script"><i>TK</i></sup><sup class="script"> − 1</sup></span><i>Y</i> − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(|<i>K</i>|) − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(2<i>π</i>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 =  − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><i>Y</i><sup><i>T</i></sup><i>α</i> − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(|<i>LL</i><sup><i>T</i></sup>|) − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(2<i>π</i>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><i>Y</i><i>α</i> − <span class="limits"><sup class="limit"><i>n</i></sup><span class="limit"><span class="bigoperator">∑</span></span><sub class="limit"><i>i</i> = 1</sub></span><span class="bigdelimiter size1">(</span>ln(<i>l</i><sub><i>ii</i></sub>)<span class="bigdelimiter size1">)</span> − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(2<i>π</i>)
</span>

</span>
</span>
</div>
<p>and</p>
<div class="formula">
<span class="environment align"><span class="arrayrow">
<span class="arraycell align-r">
<span class="fraction"><span class="ignored">(</span><span class="numerator">∂</span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span>ln(<i>p</i>(<i>Z</i><sub><i>n</i></sub>))
</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><i>Y</i><span class="scripts"><sup class="script"><i>TK</i></sup><sup class="script"> − 1</sup></span><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>K</i></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><i>K</i><sup> − 1</sup><i>Y</i> − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><span class="text"> tr</span>(<i>K</i><sup> − 1</sup><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>K</i></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><i>α</i><sup><i>T</i></sup><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>K</i></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><i>α</i> − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><span class="text"> tr</span>(<i>K</i><sup> − 1</sup><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>K</i></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>(<span class="text"> tr</span><span class="bigdelimiter size2">(</span><i>α</i><i>α</i><sup><i>T</i></sup><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>K</i></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size2">)</span> − <span class="text"> tr</span><span class="bigdelimiter size2">(</span><i>K</i><sup> − 1</sup><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>K</i></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size2">)</span>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><span class="text"> tr</span><span class="bigdelimiter size2">(</span><i>α</i><i>α</i><sup><i>T</i></sup><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>K</i></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span> − <i>K</i><sup> − 1</sup><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>K</i></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size2">)</span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><span class="text"> tr</span><span class="bigdelimiter size2">(</span>(<i>α</i><i>α</i><sup><i>T</i></sup> − <i>K</i><sup> − 1</sup>)<span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>K</i></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size2">)</span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>

</span>
</span>
</div>
<p>These are implemented in the GaussianProcessRegressor class as:</p>
<pre class="code ipython3 literal-block">
<span class="keyword">def</span> <span class="name function">_log_likelihood_calc</span><span class="punctuation">(</span><span class="name">slef</span><span class="punctuation">,</span> <span class="name">y_train</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="punctuation">,</span> <span class="name">L</span><span class="punctuation">,</span> <span class="name">K</span><span class="punctuation">):</span><span class="whitespace">
    </span><span class="literal string doc">&quot;&quot;&quot;Returns the log-likelihood of the multivariate Gaussian distribution.

    Parameters
    ----------
    y_train : array-like of shape (n_samples,) or (n_samples, n_targets)
              Target values.

    alpha : K^(-1) * y_train

    L : Lower cholesky decomposition of the kernel matrix K.

    K : Kernel matrix used.

    Returns
    -------
    log_likelihood : float
        Log-marginal likelihood of multivariate Gaussian distribution using
        covariance K and training data
    &quot;&quot;&quot;</span><span class="whitespace">
</span>    <span class="name">log_likelihood_dims</span> <span class="operator">=</span> <span class="operator">-</span><span class="literal number float">0.5</span> <span class="operator">*</span> <span class="name">np</span><span class="operator">.</span><span class="name">einsum</span><span class="punctuation">(</span><span class="literal string double">&quot;ik,ik-&gt;k&quot;</span><span class="punctuation">,</span> <span class="name">y_train</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="punctuation">)</span><span class="whitespace">
</span>    <span class="name">log_likelihood_dims</span> <span class="operator">-=</span> <span class="name">np</span><span class="operator">.</span><span class="name">log</span><span class="punctuation">(</span><span class="name">np</span><span class="operator">.</span><span class="name">diag</span><span class="punctuation">(</span><span class="name">L</span><span class="punctuation">))</span><span class="operator">.</span><span class="name">sum</span><span class="punctuation">()</span><span class="whitespace">
</span>    <span class="name">log_likelihood_dims</span> <span class="operator">-=</span> <span class="name">K</span><span class="operator">.</span><span class="name">shape</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]</span> <span class="operator">/</span> <span class="literal number integer">2</span> <span class="operator">*</span> <span class="name">np</span><span class="operator">.</span><span class="name">log</span><span class="punctuation">(</span><span class="literal number integer">2</span> <span class="operator">*</span> <span class="name">np</span><span class="operator">.</span><span class="name">pi</span><span class="punctuation">)</span><span class="whitespace">
</span>    <span class="comment single"># the log likehood is sum-up across the outputs</span><span class="whitespace">
</span>    <span class="name">log_likelihood</span> <span class="operator">=</span> <span class="name">log_likelihood_dims</span><span class="operator">.</span><span class="name">sum</span><span class="punctuation">(</span><span class="name">axis</span><span class="operator">=-</span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace">
</span>    <span class="keyword">return</span> <span class="name">log_likelihood</span><span class="whitespace">

</span><span class="keyword">def</span> <span class="name function">_log_likelihood_gradient_calc</span><span class="punctuation">(</span><span class="name builtin pseudo">self</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="punctuation">,</span> <span class="name">L</span><span class="punctuation">,</span> <span class="name">K</span><span class="punctuation">,</span> <span class="name">K_gradient</span><span class="punctuation">):</span><span class="whitespace">
    </span><span class="literal string doc">&quot;&quot;&quot;Returns the log-likelihood gradient given the required algebraic terms.

    Returns
    -------
    log_likelihood_gradient : np.array
        Log-marginal likelihood gradient with respect to theta
    &quot;&quot;&quot;</span><span class="whitespace">
</span>    <span class="name">inner_term</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">einsum</span><span class="punctuation">(</span><span class="literal string double">&quot;ik,jk-&gt;ijk&quot;</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="punctuation">)</span><span class="whitespace">
</span>    <span class="name">K_inv</span> <span class="operator">=</span> <span class="name">cho_solve</span><span class="punctuation">(</span><span class="whitespace">
</span>        <span class="punctuation">(</span><span class="name">L</span><span class="punctuation">,</span> <span class="name">GPR_CHOLESKY_LOWER</span><span class="punctuation">),</span> <span class="name">np</span><span class="operator">.</span><span class="name">eye</span><span class="punctuation">(</span><span class="name">K</span><span class="operator">.</span><span class="name">shape</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]),</span> <span class="name">check_finite</span><span class="operator">=</span><span class="keyword constant">False</span><span class="whitespace">
</span>    <span class="punctuation">)</span><span class="whitespace">
</span>    <span class="name">log_likelihood_gradient_dims</span> <span class="operator">=</span> <span class="literal number float">0.5</span> <span class="operator">*</span> <span class="name">np</span><span class="operator">.</span><span class="name">einsum</span><span class="punctuation">(</span><span class="whitespace">
</span>        <span class="literal string double">&quot;ijl,jik-&gt;kl&quot;</span><span class="punctuation">,</span> <span class="name">inner_term</span><span class="punctuation">,</span> <span class="name">K_gradient</span><span class="whitespace">
</span>    <span class="punctuation">)</span><span class="whitespace">
</span>    <span class="name">log_likelihood_gradient</span> <span class="operator">=</span> <span class="name">log_likelihood_gradient_dims</span><span class="operator">.</span><span class="name">sum</span><span class="punctuation">(</span><span class="name">axis</span><span class="operator">=-</span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace">
</span>    <span class="keyword">return</span> <span class="name">log_likelihood_gradient</span>
</pre>
<p>Kernel parameter training can easily be used by :</p>
<pre class="code ipython3 literal-block">
<span class="name">X_train</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">array</span><span class="punctuation">([[</span><span class="operator">-</span><span class="literal number integer">3</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="operator">-</span><span class="literal number integer">2</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="operator">-</span><span class="literal number integer">1</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">2</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">3</span><span class="punctuation">]])</span><span class="whitespace">
</span><span class="name">Y_train</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">sin</span><span class="punctuation">(</span><span class="name">X_train</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name">kernel</span> <span class="operator">=</span> <span class="name">RBF</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">,</span> <span class="name">length_scale_bounds</span><span class="operator">=</span><span class="punctuation">[</span><span class="literal number float">0.01</span><span class="punctuation">,</span> <span class="literal number integer">10</span><span class="punctuation">])</span><span class="whitespace">
</span><span class="name">gpr</span> <span class="operator">=</span> <span class="name">GaussianProcessRegressor</span><span class="punctuation">(</span><span class="name">kernel</span><span class="operator">=</span><span class="name">kernel</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="operator">=</span><span class="literal number float">0.0001</span><span class="punctuation">,</span> <span class="name">n_restarts_optimizer</span><span class="operator">=</span><span class="literal number integer">100</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">fit</span><span class="punctuation">(</span><span class="name">X_train</span><span class="punctuation">,</span> <span class="name">Y_train</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name">X_predict</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">linspace</span><span class="punctuation">(</span><span class="operator">-</span><span class="literal number integer">10</span><span class="punctuation">,</span> <span class="literal number integer">10</span><span class="punctuation">,</span> <span class="name">num</span><span class="operator">=</span><span class="literal number integer">300</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">reshape</span><span class="punctuation">(</span><span class="operator">-</span><span class="literal number integer">1</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">Y_true</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">sin</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name">means</span><span class="punctuation">,</span> <span class="name">stds</span> <span class="operator">=</span> <span class="name">gpr</span><span class="operator">.</span><span class="name">predict</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">,</span> <span class="name">return_std</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">confs</span> <span class="operator">=</span> <span class="name">vec_norm_conf_gp</span><span class="punctuation">(</span><span class="name">stds</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">topConf</span> <span class="operator">=</span> <span class="name">means</span> <span class="operator">+</span> <span class="name">confs</span><span class="whitespace">
</span><span class="name">botConf</span> <span class="operator">=</span> <span class="name">means</span> <span class="operator">-</span> <span class="name">confs</span><span class="whitespace">

</span><span class="name">plot_stochastic_process</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">,</span> <span class="name">Y_true</span><span class="punctuation">,</span> <span class="name">means</span><span class="punctuation">,</span> <span class="name">botConf</span><span class="punctuation">,</span> <span class="name">topConf</span><span class="punctuation">,</span> <span class="literal string single">'GP'</span><span class="punctuation">)</span>
</pre>
<img alt="sklearn/gaussian_process/media/figures/output_21_0.png" src="sklearn/gaussian_process/media/figures/output_21_0.png" />
</div>
</div>
<div class="section" id="t-process-kernel-parameter-training">
<h1><span class="formula"><i>t</i></span> Process Kernel Parameter Training</h1>
<p>At a high level, the kernel parameter training algorithm used to train
TPs is the same as what is used to train GPs. However, the equations for
log-likelihood and its derivative are different. This training algorithm
has been proposed by [SW2014] and [TW2018], however, never optimized and
implemented untill [S2024]. To compute the log-likelihood and its
derivative, first consider:</p>
<div class="formula">
<span class="environment align"><span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
<span class="text">Let </span>Ψ<sub><i>nn</i></sub> :  = <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> − 2</span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub></span><span class="ignored">)</span></span>(<i>K</i><sub><i>nn</i></sub> + Σ<sub><i>z</i></sub>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
<span class="text">Let </span><i>Y</i> :  = <i>Z</i><sub><i>n</i></sub> − <i>ϕ</i>(<i>T</i><sub><i>n</i></sub>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
<span class="text">Let </span><i>L</i> :  = <span class="text">Cholesky</span>(Ψ<sub><i>nn</i></sub>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
<span class="text">Let </span><i>l</i><sub><i>ii</i></sub> :  = <span class="text">the </span><i>i</i><sup><i>th</i></sup><span class="text"> diagonal of $L$</span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
<span class="text">Let </span><i>α</i> :  = Ψ<span class="scripts"><sup class="script"><i>T</i></sup><sub class="script"><i>nn</i></sub></span>\(Ψ<sub><i>nn</i></sub>\<i>Y</i>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
<span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span><span class="thickspace"> </span> = Ψ<span class="scripts"><sup class="script"> − 1</sup><sub class="script"><i>nn</i></sub></span><i>Y</i>
</span>

</span>
</span>
</div>
<p>Then:</p>
<div class="formula">
<span class="environment align"><span class="arrayrow">
<span class="arraycell align-r">
ln(<i>p</i>(<i>Z</i><sub><i>n</i></sub>))
</span>
<span class="arraycell align-l">
 = Γ(<span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>) − Γ(<span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>) − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(<i>v</i><sub>0</sub><i>π</i>) − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(|Ψ<sub><i>nn</i></sub>|) − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(1 + <span class="fraction"><span class="ignored">(</span><span class="numerator">(<i>ϕ</i>(<i>T</i><sub><i>n</i></sub>) − <i>Ž</i><sub><i>n</i></sub>)<sup><i>T</i></sup>Ψ<span class="scripts"><sup class="script"> − 1</sup><sub class="script"><i>nn</i></sub></span>(<i>ϕ</i>(<i>T</i><sub><i>n</i></sub>) − <i>Ž</i><sub><i>n</i></sub>)</span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub></span><span class="ignored">)</span></span>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = Γ(<span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>) − Γ(<span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>) − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(<i>v</i><sub>0</sub><i>π</i>) − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(|<i>K</i>|) − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(1 + <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>Y</i><sup><i>T</i></sup><i>K</i><sup> − 1</sup><i>Y</i></span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub></span><span class="ignored">)</span></span>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = Γ(<span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>) − Γ(<span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>) − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(<i>v</i><sub>0</sub><i>π</i>) − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(|<i>LL</i><sup><i>T</i></sup>|) − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(1 + <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>Y</i><sup><i>T</i></sup><i>α</i></span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub></span><span class="ignored">)</span></span>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = Γ(<span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>) − Γ(<span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>) − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(<i>v</i><sub>0</sub><i>π</i>) − <span class="limits"><sup class="limit"><i>n</i></sup><span class="limit"><span class="bigoperator">∑</span></span><sub class="limit"><i>i</i> = 1</sub></span><span class="bigdelimiter size1">(</span>ln(<i>l</i><sub><i>ii</i></sub>)<span class="bigdelimiter size1">)</span> − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(1 + <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>Y</i><sup><i>T</i></sup><i>α</i></span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub></span><span class="ignored">)</span></span>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = Γ(<span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>) − Γ(<span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>) − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(<i>v</i><sub>0</sub><i>π</i>) − <span class="limits"><sup class="limit"><i>n</i></sup><span class="limit"><span class="bigoperator">∑</span></span><sub class="limit"><i>i</i> = 1</sub></span><span class="bigdelimiter size1">(</span>ln(<i>l</i><sub><i>ii</i></sub>)<span class="bigdelimiter size1">)</span> − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(1 + <span class="fraction"><span class="ignored">(</span><span class="numerator">(<i>ϕ</i>(<i>T</i><sub><i>n</i></sub>) − <i>Ž</i><sub><i>n</i></sub>)<sup><i>T</i></sup><i>α</i></span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub></span><span class="ignored">)</span></span>)
</span>

</span>
</span>
</div>
<p>and</p>
<div class="formula">
<span class="environment align"><span class="arrayrow">
<span class="arraycell align-r">
<span class="fraction"><span class="ignored">(</span><span class="numerator">∂</span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span>ln<span class="bigdelimiter size1">(</span><i>p</i>(<i>Z</i>)<span class="bigdelimiter size1">)</span>
</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator">∂</span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size2">(</span>( − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(|Ψ<sub><i>nn</i></sub>|)<span class="bigdelimiter size2">)</span> + <span class="fraction"><span class="ignored">(</span><span class="numerator">∂</span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size2">(</span> − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln<span class="bigdelimiter size1">(</span>1 + <span class="fraction"><span class="ignored">(</span><span class="numerator">(<i>ϕ</i>(<i>T</i><sub><i>n</i></sub>) − <i>Ž</i><sub><i>n</i></sub>)<sup><i>T</i></sup>Ψ<span class="scripts"><sup class="script"> − 1</sup><sub class="script"><i>nn</i></sub></span>(<i>ϕ</i>(<i>T</i><sub><i>n</i></sub>) − <i>Ž</i><sub><i>n</i></sub>)</span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size1">)</span><span class="bigdelimiter size2">)</span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator">∂</span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size2">(</span>( − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln(|<i>ψ</i><sub><i>nn</i></sub>|)<span class="bigdelimiter size2">)</span> + <span class="fraction"><span class="ignored">(</span><span class="numerator">∂</span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size2">(</span> − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>ln<span class="bigdelimiter size1">(</span>1 + <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>Y</i><sup><i>T</i></sup><i>ψ</i><span class="scripts"><sup class="script"> − 1</sup><sub class="script"><i>nn</i></sub></span><i>Y</i></span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size1">)</span><span class="bigdelimiter size2">)</span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub> + <i>Y</i><sup><i>T</i></sup><i>ψ</i><span class="scripts"><sup class="script"> − 1</sup><sub class="script"><i>nn</i></sub></span><i>Y</i></span><span class="ignored">)</span></span>×<span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><i>Y</i><sup><i>T</i></sup><i>ψ</i><span class="scripts"><sup class="script"> − 1</sup><sub class="script"><i>nn</i></sub></span><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>ψ</i><sub><i>nn</i></sub></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><i>ψ</i><span class="scripts"><sup class="script"> − 1</sup><sub class="script"><i>nn</i></sub></span><i>Y</i> − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><span class="text"> tr</span>(<i>ψ</i><span class="scripts"><sup class="script"> − 1</sup><sub class="script"><i>nn</i></sub></span><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>ψ</i><sub><i>nn</i></sub></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub> + <i>Y</i><sup><i>T</i></sup><i>α</i></span><span class="ignored">)</span></span>×<span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><span class="text"> tr</span>(<i>α</i><i>α</i><sup><i>T</i></sup><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>ψ</i><sub><i>nn</i></sub></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span>) − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><span class="text"> tr</span>(<i>ψ</i><span class="scripts"><sup class="script"> − 1</sup><sub class="script"><i>nn</i></sub></span><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>ψ</i><sub><i>nn</i></sub></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span>)
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><span class="text"> tr</span><span class="bigdelimiter size2">(</span><span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub> + <i>Y</i><sup><i>T</i></sup><i>α</i></span><span class="ignored">)</span></span>×<i>α</i><i>α</i><sup><i>T</i></sup><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>ψ</i><sub><i>nn</i></sub></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span> − <i>ψ</i><span class="scripts"><sup class="script"> − 1</sup><sub class="script"><i>nn</i></sub></span><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>ψ</i><sub><i>nn</i></sub></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size2">)</span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><span class="text"> tr</span><span class="bigdelimiter size2">(</span><span class="bigdelimiter size2">(</span><span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub> + <i>Y</i><sup><i>T</i></sup><i>α</i></span><span class="ignored">)</span></span>×<i>α</i><i>α</i><sup><i>T</i></sup> − (<i>LL</i><sup><i>T</i></sup>)<sup> − 1</sup><span class="bigdelimiter size2">)</span><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>ψ</i><sub><i>nn</i></sub></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size2">)</span>
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-r">

</span>
<span class="arraycell align-l">
 = <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><span class="text"> tr</span><span class="bigdelimiter size2">(</span><span class="bigdelimiter size2">(</span><span class="fraction"><span class="ignored">(</span><span class="numerator"><i>v</i><sub>0</sub> + <i>n</i></span><span class="ignored">)/(</span><span class="denominator"><i>v</i><sub>0</sub> + (<i>Ž</i><sub><i>n</i></sub> − <i>ϕ</i>(<i>T</i><sub><i>n</i></sub>)<sup><i>T</i></sup>)<i>α</i></span><span class="ignored">)</span></span>×<i>α</i><i>α</i><sup><i>T</i></sup> − (<i>LL</i><sup><i>T</i></sup>)<sup> − 1</sup><span class="bigdelimiter size2">)</span><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>ψ</i><sub><i>nn</i></sub></span><span class="ignored">)/(</span><span class="denominator">∂<i>θ</i><sub>1</sub></span><span class="ignored">)</span></span><span class="bigdelimiter size2">)</span>
</span>

</span>
</span>
</div>
<p>These are implemented in the TProcessRegressor class as:</p>
<pre class="code ipython3 literal-block">
<span class="keyword">class</span> <span class="name class">TProcessRegressor_Demo</span><span class="punctuation">():</span><span class="whitespace">
</span>    <span class="keyword">def</span> <span class="name function">_log_likelihood_calc</span><span class="punctuation">(</span><span class="name builtin pseudo">self</span><span class="punctuation">,</span> <span class="name">y_train</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="punctuation">,</span> <span class="name">L</span><span class="punctuation">,</span> <span class="name">K</span><span class="punctuation">):</span><span class="whitespace">
        </span><span class="literal string doc">&quot;&quot;&quot;Returns the log-likelihood given L and the training points.

        Parameters
        ----------
        y_train : array-like of shape (n_samples,) or (n_samples, n_targets)
                  Target values.

        alpha : K^(-1) * y_train

        L : Lower cholesky decomposition of the kernel matrix K.

        K : Kernel matrix used.

        Returns
        -------
        log_likelihood : float
            Log-marginal likelihood of multivariate T distribution
            using covariance K and training data
        &quot;&quot;&quot;</span><span class="whitespace">
</span>        <span class="comment single"># Log-likelihood function can be found in [TW2018]</span><span class="whitespace">
</span>        <span class="comment single">### Change to shape of kernel Parameter ###</span><span class="whitespace">
</span>        <span class="name">L</span> <span class="operator">=</span> <span class="name">L</span> <span class="operator">*</span> <span class="punctuation">((</span><span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v0</span> <span class="operator">-</span> <span class="literal number integer">2</span><span class="punctuation">)</span> <span class="operator">/</span> <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v0</span><span class="punctuation">)</span> <span class="operator">**</span> <span class="literal number float">0.5</span><span class="whitespace">

</span>        <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">m_dis</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">einsum</span><span class="punctuation">(</span><span class="literal string double">&quot;ik,ik-&gt;k&quot;</span><span class="punctuation">,</span> <span class="name">y_train</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="punctuation">)</span><span class="whitespace">
</span>        <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">shape_m_dism_dis</span> <span class="operator">=</span> <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">m_dis</span> <span class="operator">*</span> <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v0</span> <span class="operator">/</span> <span class="punctuation">(</span><span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v0</span> <span class="operator">-</span> <span class="literal number integer">2</span><span class="punctuation">)</span><span class="whitespace">
</span>        <span class="name">log_likelihood_dims</span> <span class="operator">=</span> <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">log_likelihood_dims_const</span><span class="whitespace">
</span>        <span class="name">log_likelihood_dims</span> <span class="operator">-=</span> <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">c_fit1</span> <span class="operator">*</span> <span class="name">np</span><span class="operator">.</span><span class="name">log</span><span class="punctuation">(</span><span class="literal number integer">1</span> <span class="operator">+</span> <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">shape_m_dism_dis</span> <span class="operator">/</span> <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v0</span><span class="punctuation">)</span><span class="whitespace">
</span>        <span class="name">log_likelihood_dims</span> <span class="operator">-=</span> <span class="name">np</span><span class="operator">.</span><span class="name">log</span><span class="punctuation">(</span><span class="name">np</span><span class="operator">.</span><span class="name">diag</span><span class="punctuation">(</span><span class="name">L</span><span class="punctuation">))</span><span class="operator">.</span><span class="name">sum</span><span class="punctuation">()</span><span class="whitespace">
</span>        <span class="name">log_likelihood</span> <span class="operator">=</span> <span class="name">log_likelihood_dims</span><span class="operator">.</span><span class="name">sum</span><span class="punctuation">(</span><span class="name">axis</span><span class="operator">=-</span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace">
</span>        <span class="keyword">return</span> <span class="name">log_likelihood</span><span class="whitespace">

</span>        <span class="keyword">def</span> <span class="name function">_log_likelihood_gradient_calc</span><span class="punctuation">(</span><span class="name builtin pseudo">self</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="punctuation">,</span> <span class="name">L</span><span class="punctuation">,</span> <span class="name">K</span><span class="punctuation">,</span> <span class="name">K_gradient</span><span class="punctuation">):</span><span class="whitespace">
            </span><span class="literal string doc">&quot;&quot;&quot;Returns the log-likelihood gradient given the required algebraic terms.

            Parameters
            ----------
            y_train : array-like of shape (n_samples,) or (n_samples, n_targets)
                      Target values.

            alpha : K^(-1) * y_train

            L : Lower cholesky decomposition of the kernel matrix K.

            K : Kernel matrix used.

            Returns
            -------
            log_likelihood_gradient : np.array
                Log-marginal likelihood gradient with respect to theta
            &quot;&quot;&quot;</span><span class="whitespace">
</span>            <span class="name">L</span> <span class="operator">=</span> <span class="name">L</span> <span class="operator">*</span> <span class="punctuation">((</span><span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v0</span> <span class="operator">-</span> <span class="literal number integer">2</span><span class="punctuation">)</span> <span class="operator">/</span> <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v0</span><span class="punctuation">)</span> <span class="operator">**</span> <span class="literal number float">0.5</span><span class="whitespace">
</span>            <span class="name">alpha</span> <span class="operator">=</span> <span class="name">alpha</span> <span class="operator">*</span> <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v0</span> <span class="operator">/</span> <span class="punctuation">(</span><span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v0</span> <span class="operator">-</span> <span class="literal number integer">2</span><span class="punctuation">)</span><span class="whitespace">
</span>            <span class="name">K_gradient</span> <span class="operator">=</span> <span class="name">K_gradient</span> <span class="operator">*</span> <span class="punctuation">(</span><span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v0</span> <span class="operator">-</span> <span class="literal number integer">2</span><span class="punctuation">)</span> <span class="operator">/</span> <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v0</span><span class="whitespace">

</span>            <span class="name">inner_term</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">einsum</span><span class="punctuation">(</span><span class="literal string double">&quot;ik,jk-&gt;ijk&quot;</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="punctuation">)</span><span class="whitespace">
</span>            <span class="name">inner_term</span> <span class="operator">=</span> <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v</span> <span class="operator">/</span> <span class="punctuation">(</span><span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">v0</span> <span class="operator">+</span> <span class="name builtin pseudo">self</span><span class="operator">.</span><span class="name">shape_m_dism_dis</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="name">inner_term</span><span class="whitespace">
</span>            <span class="name">K_inv</span> <span class="operator">=</span> <span class="name">cho_solve</span><span class="punctuation">(</span><span class="whitespace">
</span>                <span class="punctuation">(</span><span class="name">L</span><span class="punctuation">,</span> <span class="name">GPR_CHOLESKY_LOWER</span><span class="punctuation">),</span> <span class="name">np</span><span class="operator">.</span><span class="name">eye</span><span class="punctuation">(</span><span class="name">K</span><span class="operator">.</span><span class="name">shape</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]),</span> <span class="name">check_finite</span><span class="operator">=</span><span class="keyword constant">False</span><span class="whitespace">
</span>            <span class="punctuation">)</span><span class="whitespace">
</span>            <span class="name">inner_term</span> <span class="operator">-=</span> <span class="name">K_inv</span><span class="punctuation">[</span><span class="operator">...</span><span class="punctuation">,</span> <span class="name">np</span><span class="operator">.</span><span class="name">newaxis</span><span class="punctuation">]</span><span class="whitespace">
</span>            <span class="name">log_likelihood_gradient_dims</span> <span class="operator">=</span> <span class="literal number float">0.5</span> <span class="operator">*</span> <span class="name">np</span><span class="operator">.</span><span class="name">einsum</span><span class="punctuation">(</span><span class="whitespace">
</span>                <span class="literal string double">&quot;ijl,jik-&gt;kl&quot;</span><span class="punctuation">,</span> <span class="name">inner_term</span><span class="punctuation">,</span> <span class="name">K_gradient</span><span class="whitespace">
</span>            <span class="punctuation">)</span><span class="whitespace">
</span>            <span class="comment single"># the log likehood gradient is the sum-up across the outputs</span><span class="whitespace">
</span>            <span class="name">log_likelihood_gradient</span> <span class="operator">=</span> <span class="name">log_likelihood_gradient_dims</span><span class="operator">.</span><span class="name">sum</span><span class="punctuation">(</span><span class="name">axis</span><span class="operator">=-</span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace">
</span>            <span class="keyword">return</span> <span class="name">log_likelihood_gradient</span>
</pre>
<p>Just as in the GP case, kernel parameter tuning can easily be used:</p>
<pre class="code ipython3 literal-block">
<span class="name">X_train</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">array</span><span class="punctuation">([[</span><span class="operator">-</span><span class="literal number integer">3</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="operator">-</span><span class="literal number integer">2</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="operator">-</span><span class="literal number integer">1</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">2</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">3</span><span class="punctuation">]])</span><span class="whitespace">
</span><span class="name">Y_train</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">sin</span><span class="punctuation">(</span><span class="name">X_train</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name">kernel</span> <span class="operator">=</span> <span class="name">RBF</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">,</span> <span class="name">length_scale_bounds</span><span class="operator">=</span><span class="punctuation">[</span><span class="literal number float">0.01</span><span class="punctuation">,</span> <span class="literal number integer">10</span><span class="punctuation">])</span><span class="whitespace">
</span><span class="name">tpr</span> <span class="operator">=</span> <span class="name">TProcessRegressor</span><span class="punctuation">(</span><span class="name">kernel</span><span class="operator">=</span><span class="name">kernel</span><span class="punctuation">,</span> <span class="name">v</span><span class="operator">=</span><span class="literal number integer">5</span><span class="punctuation">,</span> <span class="name">alpha</span><span class="operator">=</span><span class="literal number float">0.0001</span><span class="punctuation">,</span> <span class="name">n_restarts_optimizer</span><span class="operator">=</span><span class="literal number integer">100</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">fit</span><span class="punctuation">(</span><span class="name">X_train</span><span class="punctuation">,</span> <span class="name">Y_train</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name">X_predict</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">linspace</span><span class="punctuation">(</span><span class="operator">-</span><span class="literal number integer">10</span><span class="punctuation">,</span> <span class="literal number integer">10</span><span class="punctuation">,</span> <span class="name">num</span><span class="operator">=</span><span class="literal number integer">300</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">reshape</span><span class="punctuation">(</span><span class="operator">-</span><span class="literal number integer">1</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">Y_true</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">sin</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name">means</span><span class="punctuation">,</span> <span class="name">stds</span> <span class="operator">=</span> <span class="name">tpr</span><span class="operator">.</span><span class="name">predict</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">,</span> <span class="name">return_std</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">confs</span> <span class="operator">=</span> <span class="name">vec_norm_conf_tp</span><span class="punctuation">(</span><span class="name">stds</span><span class="punctuation">,</span> <span class="name">tpr</span><span class="operator">.</span><span class="name">v</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">topConf</span> <span class="operator">=</span> <span class="name">means</span> <span class="operator">+</span> <span class="name">confs</span><span class="whitespace">
</span><span class="name">botConf</span> <span class="operator">=</span> <span class="name">means</span> <span class="operator">-</span> <span class="name">confs</span><span class="whitespace">

</span><span class="name">plot_stochastic_process</span><span class="punctuation">(</span><span class="name">X_predict</span><span class="punctuation">,</span> <span class="name">Y_true</span><span class="punctuation">,</span> <span class="name">means</span><span class="punctuation">,</span> <span class="name">botConf</span><span class="punctuation">,</span> <span class="name">topConf</span><span class="punctuation">,</span> <span class="literal string single">'TP'</span><span class="punctuation">)</span>
</pre>
<img alt="sklearn/gaussian_process/media/figures/output_28_0.png" src="sklearn/gaussian_process/media/figures/output_28_0.png" />
<p>When training the kernel parameters, the predicted values of TPs and GPs
are typically more similar. However, in this case it can be seen there
is slightly more confidence near the observed parts of the curve.</p>
</div>
<div class="section" id="references">
<h1>References</h1>
<p>[RW2006]
<tt class="docutils literal">Carl E. Rasmussen and Christopher K.I. Williams, &quot;Gaussian Processes for Machine Learning&quot;, MIT Press 2006 <span class="pre">&lt;https://www.gaussianprocess.org/gpml/chapters/RW.pdf&gt;</span></tt></p>
<p>[SW2014]
<tt class="docutils literal">Amar Shah, Andrew Gordon Wilson, Zoubin Ghahramani, <span class="pre">&quot;Student-t</span> Processes as Alternatives to Gaussian Processes&quot;, arxiv &gt; stat &gt; arXiv:1402.4306 <span class="pre">&lt;https://arxiv.org/abs/1402.4306&gt;</span></tt></p>
<p>[TW2018]
<tt class="docutils literal">Brendan D. Tracey, David H. Wolpert, &quot;Upgrading from Gaussian Processes to <span class="pre">Student's-T</span> Processes&quot; arxiv &gt; stat &gt; arXiv:1801.06147 <span class="pre">&lt;https://arxiv.org/abs/1801.06147&gt;</span></tt></p>
<p>[S2024]
<tt class="docutils literal">Stevens Conrad &quot;Towards Analytic Informative Path Planning&quot;, The University of Sydney Library <span class="pre">&lt;https://hdl.handle.net/2123/33299&gt;</span></tt></p>
<p>The below is from the main Scikit-Learn repository.</p>
<hr class="docutils" />
<p><a class="reference external image-reference" href="https://dev.azure.com/scikit-learn/scikit-learn/_build/latest?definitionId=1&amp;branchName=main"><img alt="Azure" src="https://dev.azure.com/scikit-learn/scikit-learn/_apis/build/status/scikit-learn.scikit-learn?branchName=main" /></a> <a class="reference external image-reference" href="https://cirrus-ci.com/github/scikit-learn/scikit-learn/main"><img alt="CirrusCI" src="https://img.shields.io/cirrus/github/scikit-learn/scikit-learn/main?label=Cirrus%20CI" /></a> <a class="reference external image-reference" href="https://codecov.io/gh/scikit-learn/scikit-learn"><img alt="Codecov" src="https://codecov.io/gh/scikit-learn/scikit-learn/branch/main/graph/badge.svg?token=Pk8G9gg3y9" /></a> <a class="reference external image-reference" href="https://circleci.com/gh/scikit-learn/scikit-learn"><img alt="CircleCI" src="https://circleci.com/gh/scikit-learn/scikit-learn/tree/main.svg?style=shield" /></a> <a class="reference external image-reference" href="https://github.com/scikit-learn/scikit-learn/actions?query=workflow%3A%22Wheel+builder%22+event%3Aschedule"><img alt="Nightly wheels" src="https://github.com/scikit-learn/scikit-learn/workflows/Wheel%20builder/badge.svg?event=schedule" /></a> <a class="reference external image-reference" href="https://github.com/psf/black"><object data="https://img.shields.io/badge/code%20style-black-000000.svg" type="image/svg+xml">Black</object></a> <a class="reference external image-reference" href="https://pypi.org/project/scikit-learn/"><object data="https://img.shields.io/pypi/pyversions/scikit-learn.svg" type="image/svg+xml">PythonVersion</object></a> <a class="reference external image-reference" href="https://pypi.org/project/scikit-learn"><img alt="PyPi" src="https://img.shields.io/pypi/v/scikit-learn" /></a> <a class="reference external image-reference" href="https://zenodo.org/badge/latestdoi/21369/scikit-learn/scikit-learn"><object data="https://zenodo.org/badge/21369/scikit-learn/scikit-learn.svg" type="image/svg+xml">DOI</object></a> <a class="reference external image-reference" href="https://scikit-learn.org/scikit-learn-benchmarks"><img alt="Benchmark" src="https://img.shields.io/badge/Benchmarked%20by-asv-blue" /></a></p>
<a class="reference external image-reference" href="https://scikit-learn.org/">
<img alt="https://raw.githubusercontent.com/scikit-learn/scikit-learn/main/doc/logos/scikit-learn-logo.png" src="https://raw.githubusercontent.com/scikit-learn/scikit-learn/main/doc/logos/scikit-learn-logo.png" />
</a>
<p><strong>scikit-learn</strong> is a Python module for machine learning built on top of
SciPy and is distributed under the 3-Clause BSD license.</p>
<p>The project was started in 2007 by David Cournapeau as a Google Summer
of Code project, and since then many volunteers have contributed. See
the <a class="reference external" href="https://scikit-learn.org/dev/about.html#authors">About us</a> page
for a list of core contributors.</p>
<p>It is currently maintained by a team of volunteers.</p>
<p>Website: <a class="reference external" href="https://scikit-learn.org">https://scikit-learn.org</a></p>
</div>
<div class="section" id="installation">
<h1>Installation</h1>
<div class="section" id="dependencies">
<h2>Dependencies</h2>
<p>scikit-learn requires:</p>
<ul class="simple">
<li>Python (&gt;= 3.9)</li>
<li>NumPy (&gt;= 1.19.5)</li>
<li>SciPy (&gt;= 1.6.0)</li>
<li>joblib (&gt;= 1.2.0)</li>
<li>threadpoolctl (&gt;= 3.1.0)</li>
</ul>
<hr class="docutils" />
<p><strong>Scikit-learn 0.20 was the last version to support Python 2.7 and Python 3.4.</strong>
scikit-learn 1.0 and later require Python 3.7 or newer.
scikit-learn 1.1 and later require Python 3.8 or newer.</p>
<p>Scikit-learn plotting capabilities (i.e., functions start with <tt class="docutils literal">plot_</tt> and
classes end with <tt class="docutils literal">Display</tt>) require Matplotlib (&gt;= 3.3.4).
For running the examples Matplotlib &gt;= 3.3.4 is required.
A few examples require scikit-image &gt;= 0.17.2, a few examples
require pandas &gt;= 1.1.5, some examples require seaborn &gt;=
0.9.0 and plotly &gt;= 5.14.0.</p>
</div>
<div class="section" id="user-installation">
<h2>User installation</h2>
<p>If you already have a working installation of NumPy and SciPy,
the easiest way to install scikit-learn is using <tt class="docutils literal">pip</tt>:</p>
<pre class="literal-block">
pip install -U scikit-learn
</pre>
<p>or <tt class="docutils literal">conda</tt>:</p>
<pre class="literal-block">
conda install -c conda-forge scikit-learn
</pre>
<p>The documentation includes more detailed <a class="reference external" href="https://scikit-learn.org/stable/install.html">installation instructions</a>.</p>
</div>
</div>
<div class="section" id="changelog">
<h1>Changelog</h1>
<p>See the <a class="reference external" href="https://scikit-learn.org/dev/whats_new.html">changelog</a>
for a history of notable changes to scikit-learn.</p>
</div>
<div class="section" id="development">
<h1>Development</h1>
<p>We welcome new contributors of all experience levels. The scikit-learn
community goals are to be helpful, welcoming, and effective. The
<a class="reference external" href="https://scikit-learn.org/stable/developers/index.html">Development Guide</a>
has detailed information about contributing code, documentation, tests, and
more. We've included some basic information in this README.</p>
<div class="section" id="important-links">
<h2>Important links</h2>
<ul class="simple">
<li>Official source code repo: <a class="reference external" href="https://github.com/scikit-learn/scikit-learn">https://github.com/scikit-learn/scikit-learn</a></li>
<li>Download releases: <a class="reference external" href="https://pypi.org/project/scikit-learn/">https://pypi.org/project/scikit-learn/</a></li>
<li>Issue tracker: <a class="reference external" href="https://github.com/scikit-learn/scikit-learn/issues">https://github.com/scikit-learn/scikit-learn/issues</a></li>
</ul>
</div>
<div class="section" id="source-code">
<h2>Source code</h2>
<p>You can check the latest sources with the command:</p>
<pre class="literal-block">
git clone https://github.com/scikit-learn/scikit-learn.git
</pre>
</div>
<div class="section" id="contributing">
<h2>Contributing</h2>
<p>To learn more about making a contribution to scikit-learn, please see our
<a class="reference external" href="https://scikit-learn.org/dev/developers/contributing.html">Contributing guide</a>.</p>
</div>
<div class="section" id="testing">
<h2>Testing</h2>
<p>After installation, you can launch the test suite from outside the source
directory (you will need to have <tt class="docutils literal">pytest</tt> &gt;= 7.1.2 installed):</p>
<pre class="literal-block">
pytest sklearn
</pre>
<p>See the web page <a class="reference external" href="https://scikit-learn.org/dev/developers/contributing.html#testing-and-improving-test-coverage">https://scikit-learn.org/dev/developers/contributing.html#testing-and-improving-test-coverage</a>
for more information.</p>
<blockquote>
Random number generation can be controlled during testing by setting
the <tt class="docutils literal">SKLEARN_SEED</tt> environment variable.</blockquote>
</div>
<div class="section" id="submitting-a-pull-request">
<h2>Submitting a Pull Request</h2>
<p>Before opening a Pull Request, have a look at the
full Contributing page to make sure your code complies
with our guidelines: <a class="reference external" href="https://scikit-learn.org/stable/developers/index.html">https://scikit-learn.org/stable/developers/index.html</a></p>
</div>
</div>
<div class="section" id="project-history">
<h1>Project History</h1>
<p>The project was started in 2007 by David Cournapeau as a Google Summer
of Code project, and since then many volunteers have contributed. See
the <a class="reference external" href="https://scikit-learn.org/dev/about.html#authors">About us</a> page
for a list of core contributors.</p>
<p>The project is currently maintained by a team of volunteers.</p>
<p><strong>Note</strong>: <cite>scikit-learn</cite> was previously referred to as <cite>scikits.learn</cite>.</p>
</div>
<div class="section" id="help-and-support">
<h1>Help and Support</h1>
<div class="section" id="documentation">
<h2>Documentation</h2>
<ul class="simple">
<li>HTML documentation (stable release): <a class="reference external" href="https://scikit-learn.org">https://scikit-learn.org</a></li>
<li>HTML documentation (development version): <a class="reference external" href="https://scikit-learn.org/dev/">https://scikit-learn.org/dev/</a></li>
<li>FAQ: <a class="reference external" href="https://scikit-learn.org/stable/faq.html">https://scikit-learn.org/stable/faq.html</a></li>
</ul>
</div>
<div class="section" id="communication">
<h2>Communication</h2>
<ul class="simple">
<li>Mailing list: <a class="reference external" href="https://mail.python.org/mailman/listinfo/scikit-learn">https://mail.python.org/mailman/listinfo/scikit-learn</a></li>
<li>Logos &amp; Branding: <a class="reference external" href="https://github.com/scikit-learn/scikit-learn/tree/main/doc/logos">https://github.com/scikit-learn/scikit-learn/tree/main/doc/logos</a></li>
<li>Blog: <a class="reference external" href="https://blog.scikit-learn.org">https://blog.scikit-learn.org</a></li>
<li>Calendar: <a class="reference external" href="https://blog.scikit-learn.org/calendar/">https://blog.scikit-learn.org/calendar/</a></li>
<li>Twitter: <a class="reference external" href="https://twitter.com/scikit_learn">https://twitter.com/scikit_learn</a></li>
<li>Stack Overflow: <a class="reference external" href="https://stackoverflow.com/questions/tagged/scikit-learn">https://stackoverflow.com/questions/tagged/scikit-learn</a></li>
<li>GitHub Discussions: <a class="reference external" href="https://github.com/scikit-learn/scikit-learn/discussions">https://github.com/scikit-learn/scikit-learn/discussions</a></li>
<li>Website: <a class="reference external" href="https://scikit-learn.org">https://scikit-learn.org</a></li>
<li>LinkedIn: <a class="reference external" href="https://www.linkedin.com/company/scikit-learn">https://www.linkedin.com/company/scikit-learn</a></li>
<li>Bluesky: <a class="reference external" href="https://bsky.app/profile/scikit-learn.org">https://bsky.app/profile/scikit-learn.org</a></li>
<li>YouTube: <a class="reference external" href="https://www.youtube.com/channel/UCJosFjYm0ZYVUARxuOZqnnw/playlists">https://www.youtube.com/channel/UCJosFjYm0ZYVUARxuOZqnnw/playlists</a></li>
<li>Facebook: <a class="reference external" href="https://www.facebook.com/scikitlearnofficial/">https://www.facebook.com/scikitlearnofficial/</a></li>
<li>Instagram: <a class="reference external" href="https://www.instagram.com/scikitlearnofficial/">https://www.instagram.com/scikitlearnofficial/</a></li>
<li>TikTok: <a class="reference external" href="https://www.tiktok.com/&#64;scikit.learn">https://www.tiktok.com/&#64;scikit.learn</a></li>
<li>Mastodon: <a class="reference external" href="https://mastodon.social/&#64;sklearn&#64;fosstodon.org">https://mastodon.social/&#64;sklearn&#64;fosstodon.org</a></li>
<li>Discord: <a class="reference external" href="https://discord.gg/h9qyrK8Jc8">https://discord.gg/h9qyrK8Jc8</a></li>
</ul>
</div>
<div class="section" id="citation">
<h2>Citation</h2>
<p>If you use scikit-learn in a scientific publication, we would appreciate citations: <a class="reference external" href="https://scikit-learn.org/stable/about.html#citing-scikit-learn">https://scikit-learn.org/stable/about.html#citing-scikit-learn</a></p>
</div>
</div>
</div>
</body>
</html>
